<?php

require '../template.php';
require 'menu.php';

$html  = getHeader('..', 'interior', 'Documentation / API / Methods');
$html .= '<div class="content-primary">';

$html .= '<fieldset class="ui-grid-a">';
$html .= '<div class="ui-block-a">';
$html .= '<a class="expand" href="#" data-role="button" data-mini="true">Expand all</a></div>';
$html .= '<div class="ui-block-b">';
$html .= '<a class="collapse" href="#" data-role="button" data-mini="true">Collapse all</a></div>';
$html .= '</fieldset>';

$html .= '<h2>Methods</h2>';


$template  = '<div data-role="collapsible"';
$template .= ' data-theme="b" data-content-theme="d"';
$template .= ' data-collapsed-icon="arrow-r" data-expanded-icon="arrow-d">';
$template .= '<h3>%s</h3>';
$template .= '<p class="ui-li-aside"><strong>Returns:</strong> %s</p>';
$template .= '<p><strong>Description:</strong><br />%s</p>';
$template .= '<p><strong>Parameters:</strong> %s</p>';
$template .= '%s';
$template .= '%s';
$template .= '</div>';

$properties = array(
    'api()' => array(
        'params' => array(),
        'return' => 'An <a href="./api-object.html">API object</a>',
        'description' => 'Provides faster access to the ChromoSelector API.',
        'links' => array(
            array('url' => './api-object.html', 'text' => 'Object - API')
        )
    ),
    'destroy()' => array(
        'params' => array(),
        'return' => '<i>void</i>',
        'description' => 'Destroys the color picker, unbinds all registered events and removes itself from the DOM.',
        'samples' => array(
            "$(document).ready(function () {\n"
                ."    // Create the color picker\n"
                ."    $('input.color').chromoselector();\n"
                ."    // Destroy the color picker if we are about\n"
                ."    // to swap out the contents of the page\n"
                ."    $('#changePage').click(function () {\n"
                ."        $('input.color').chromoselector('destroy');\n"
                ."    });\n"
                ."});\n"
        ),
        'links' => array(
            array('url' => './events.html#destroy', 'text' => 'Events - destroy')
        )
    ),
    'getColor()' => array(
        'params' => array(),
        'return' => 'A <a href="./color-manipulation.html">Color</a> object',
        'description' => 'Retrieves to currently selected color in the picker.',
        'samples' => array(
            "$(document).ready(function () {\n"
                ."    // Create the color picker\n"
                ."    $('#myColorPicker').chromoselector();\n"
                ."    // Get the current color\n"
                ."    var color = $('#myColorPicker').chromoselector('getColor');\n"
                ."    // Print the color to the console in different formats\n"
                ."    console.log(color.hex, color.rgb, color.hsl, color.cmyk);\n"
                ."});\n"
        )
    ),
    'getHeight()' => array(
        'params' => array(),
        'return' => 'Integer',
        'description' => 'Retrieves the current height of the picker in pixels.',
        'samples' => array(
            "$(document).ready(function () {\n"
                ."    // Create the color picker\n"
                ."    $('#myColorPicker').chromoselector();\n"
                ."    // Prints the current height\n"
                ."    console.log($('#myColorPicker').chromoselector('getHeight'));\n"
                ."});\n"
        )
    ),
    'getWidth()' => array(
        'params' => array(),
        'return' => 'Integer',
        'description' => 'Retrieves the current width of the picker in pixels.',
        'samples' => array(
            "$(document).ready(function () {\n"
                ."    // Create the color picker\n"
                ."    $('#myColorPicker').chromoselector();\n"
                ."    // Prints the current width\n"
                ."    console.log($('#myColorPicker').chromoselector('getWidth'));\n"
                ."});\n"
        )
    ),
    'hide()' => array(
        'params' => array(
            array(
                'type' => 'int',
                'name' => 'speed',
                'comment' => 'Duration of the transition animation in milliseconds'
            )
        ),
        'return' => '<i>self</i> (Can be chained)',
        'description' => 'Initiates a hide operation. Note that that the operation may be aborted if '
                        . 'a "beforeHide" event returns a value that evaluates to <i>false</i>.',
        'samples' => array(
            "$(document).ready(function () {\n"
                ."    // Create the color picker\n"
                ."    $('#myColorPicker').chromoselector();\n"
                ."    // Hide picker when the user clicks on an external close button\n"
                ."    $('#closeButton').click(function () {\n"
                ."        $('#myColorPicker').chromoselector('hide');\n"
                ."    });\n"
                ."});\n"
        )
    ),
    'load()' => array(
        'params' => array(),
        'return' => '<i>self</i> (Can be chained)',
        'description' => 'Loads the color value from the source text input into the color picker. (Triggers a redraw operation)',
        'links' => array(
            array('url' => '../demos/ui-dialog.html', 'text' => 'Demo - Dialog')
        )
    ),
    'reflow()' => array(
        'params' => array(),
        'return' => '<i>self</i> (Can be chained)',
        'description' => 'Repositions the color picker and the icon relatively to the source text input. '
                        . 'Should be called when the layout of the page is updated.',
        'samples' => array(
            "$(document).ready(function () {\n"
                ."    // Create the color picker\n"
                ."    $('#myColorPicker').chromoselector();\n"
                ."    setTimeout(function () {\n"
                ."        // Hide the message at the top of the page\n"
                ."        $('#top_message').click(function () {\n"
                ."            // Fix the position of the colorpicker since the page layout has changed\n"
                ."            $('#myColorPicker').chromoselector('reflow');\n"
                ."        });\n"
                ."    }, 1000);\n"
                ."});\n"
        )
    ),
    'resize()' => array(
        'params' => array(
            array(
                'type' => 'int',
                'name' => 'size',
                'comment' => 'The new width'
            )
        ),
        'return' => '<i>self</i> (Can be chained)',
        'description' => 'Resizes the color-picker to the specified width.',
        'samples' => array(
            "$(document).ready(function () {\n"
                ."    // Create the color picker\n"
                ."    $('#myColorPicker').chromoselector();\n"
                ."    // Set its width to 300px\n"
                ."    $('#myColorPicker').chromoselector('resize', 300);\n"
                ."    // The above is the same as:\n"
                ."    // $('#myColorPicker').chromoselector({ width:300 });\n"
                ."});\n"
        )
    ),
    'save()' => array(
        'params' => array(),
        'return' => '<i>self</i> (Can be chained)',
        'description' => 'Saves the value of the currently selected color into the source text input.',
        'samples' => array(
            "$(document).ready(function () {\n"
                ."    // Same as setting autosave to true\n"
                ."    $('input.color').chromoselector({\n"
                ."        autosave: false,\n"
                ."        update: function () {\n"
                ."            $(this).chromoselector('save');\n"
                ."        }\n"
                ."    });\n"
                ."});\n"
        )
    ),
    'setColor()' => array(
        'params' => array(
            array(
                'type' => '<a href="./color-manipulation.html">Color object</a> | Object | string',
                'name' => 'color',
                'comment' => 'The new color'
            )
        ),
        'return' => '<i>self</i> (Can be chained)',
        'description' => 'Changes the currently selected color in the color picker. This method is serviced asynchronously, so the color change may not occur immediately.',
        'samples' => array(
            "$(document).ready(function () {\n"
                ."    var \$pickers = $('input.color').chromoselector();\n"
                ."    // Set color to green\n"
                ."    \$pickers.chromoselector('setColor', '#0f0');\n"
                ."    // Set color to orange\n"
                ."    \$pickers.chromoselector('setColor', '#ff8000');\n"
                ."    // Set color to blue\n"
                ."    \$pickers.chromoselector('setColor', { r:0, g:0, b:1 });\n"
                ."    // Set color to aqua\n"
                ."    \$pickers.chromoselector('setColor', { h:0.5, s:1, l:0.5 });\n"
                ."    // Set color to red\n"
                ."    \$pickers.chromoselector('setColor', { c:0, m:1, y: 1, k:0 });\n"
                ."});\n"
        )
    ),
    'show()' => array(
        'params' => array(
            array(
                'type' => 'int',
                'name' => 'speed',
                'comment' => 'Duration of the transition animation in milliseconds'
            )
        ),
        'return' => '<i>self</i> (Can be chained)',
        'description' => 'Shows the color picker.',
        'samples' => array(
            "$(document).ready(function () {\n"
                ."    // Create the color picker\n"
                ."    $('#myColorPicker').chromoselector();\n"
                ."    // Show it immediately\n"
                ."    $('#myColorPicker').chromoselector('show');\n"
                ."});\n"
        )
    ),
);


foreach ($properties as $key => $value) {
    $samples = '';
    if (! empty($value['samples'])) {
        $samples .= '<p><strong>Sample usage:</strong>';
        foreach ($value['samples'] as $sample) {
            $samples .= '<pre><code class="javascript">' . htmlspecialchars($sample) . '</code></pre>';
        }
        $samples .= '</p>';
    }

    $params = '';
    if (! empty($value['params'])) {
        $params .= '<ul>';
        foreach ($value['params'] as $param) {
            $params .= '<li>'. $param['type'];
            $params .= ' <strong>' . htmlspecialchars($param['name']) . '</strong>';
            $params .= ': ' . htmlspecialchars($param['comment']) . '</li>';
        }
        $params .= '</ul>';
    } else {
        $params .= '<i>None</i>';
    }

    $links = '';
    if (! empty($value['links'])) {
        $links = '<strong>See also:</strong><ul>';
        foreach ($value['links'] as $link) {
            $links .= '<li>';
            $links .= '<a href="'. $link['url'] . '">' . $link['text'] . '</a>';
            $links .= '</li>';
        }
        $links .= '</ul>';
    }

    $html .= sprintf(
        $template,
        $key,
        $value['return'],
        $value['description'],
        $params,
        $samples,
        $links
    );
}


$html .= '</div>';
$html .= '<div class="content-secondary">';
$html .= '<ul data-role="listview"  data-theme="c" data-dividertheme="d">';
$html .= getApiMenu('..', 'methods');
$html .= '</ul>';
$html .= '</div>';
$html .= getFooter();

echo $html;

?>
