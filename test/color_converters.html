<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="../jquery-1.9.1.min.js" type="text/javascript"></script>
    <script src="../chromoselector.js" type="text/javascript"></script>
    <script type="text/javascript">
    var Color = TESTSUITE.Color;
    var startTime = new Date();
    $(function () {
        $('#start1').click(function () {
            startTime = new Date();
            test1(0);
        });
        $('#start2').click(function () {
            startTime = new Date();
            test2(0);
        });
        $('#start3').click(function () {
            startTime = new Date();
            test3(0);
        });
    });
    function round(v) {
        return Math.round(v * 10000000) / 10000000;
    }

    function test1(r) {
        $('#test1 > div > div').width((r / 255) * 400);
        for (var g = 0; g < 256; g++) {
            for (var b = 0; b < 256; b++) {
                var oldColor = {r:round(r/255),g:round(g/255),b:round(b/255)};
                var newColor = new Color(
                    new Color(
                        oldColor
                    ).cmyk
                ).rgb;
                newColor.r = round(newColor.r);
                newColor.g = round(newColor.g);
                newColor.b = round(newColor.b);
                if (oldColor.r != newColor.r
                    || oldColor.g != newColor.g
                    || oldColor.b != newColor.b
                ) {
                    $('#error').append( "test1: " +
                        oldColor.r + "," + oldColor.g + "," + oldColor.b + " -> "
                        + newColor.r + "," + newColor.g + "," + newColor.b + "\n"
                    )
                }
            }
        }
        if (r < 255) {
            setTimeout(function () { test1(++r) }, 1);
        } else {
            $('#test1').append((new Date() - startTime) + ' mS<br />')
        }
    }



    function test2(r) {
        $('#test2 > div > div').width((r / 255) * 400);
        for (var g = 0; g < 256; g++) {
            for (var b = 0; b < 256; b++) {
                var oldColor = {r:round(r/255),g:round(g/255),b:round(b/255)};
                var newColor = new Color(
                    new Color(
                        oldColor
                    ).hsl
                ).rgb;
                newColor.r = round(newColor.r);
                newColor.g = round(newColor.g);
                newColor.b = round(newColor.b);
                if (oldColor.r != newColor.r
                    || oldColor.g != newColor.g
                    || oldColor.b != newColor.b
                ) {
                    $('#error').append( "test2: " +
                        oldColor.r + "," + oldColor.g + "," + oldColor.b + " -> "
                        + newColor.r + "," + newColor.g + "," + newColor.b + "\n"
                    )
                }
            }
        }
        if (r < 255) {
            setTimeout(function () { test2(++r) }, 1);
        } else {
            $('#test2').append((new Date() - startTime) + ' mS<br />')
        }
    }
    function test3(r) {
        $('#test3 > div > div').width((r / 255) * 400);
        for (var g = 0; g < 256; g++) {
            for (var b = 0; b < 256; b++) {
                var oldColor = {r:r/255,g:g/255,b:b/255};
                var newColor = new Color(
                    new Color(
                        oldColor
                    ).hex
                ).rgb;
                if (oldColor.r != newColor.r
                    || oldColor.g != newColor.g
                    || oldColor.b != newColor.b
                ) {
                    $('#error').append( "test3: " +
                        oldColor.r + "," + oldColor.g + "," + oldColor.b + " -> "
                        + newColor.r + "," + newColor.g + "," + newColor.b + "\n"
                    )
                }
            }
        }
        if (r < 255) {
            setTimeout(function () { test3(++r) }, 1);
        } else {
            $('#test3').append((new Date() - startTime) + ' mS<br />')
        }
    }
    </script>
    <style type="text/css">
        body {
            margin: 2em;
            background: #adf;
        }
        body > div {
            margin: .2em;
        }
        .progress_container {
            width: 400px;
            height: 12px;
            border: 1px solid #333;
            margin: .2em;
        }
        .progress_container div {
            width: 0px;
            height: 12px;
            background: #2f6;
        }
    </style>
</head>
<body>
    <div id="test1">
        rgb2cmyk and back
        <div class="progress_container"><div></div></div>
    </div>
    <button id="start1">Start</button>
    <div id="test2">
        rgb2hsl and back
        <div class="progress_container"><div></div></div>
    </div>
    <button id="start2">Start</button>
    <div id="test3">
        rgb2hex and back
        <div class="progress_container"><div></div></div>
    </div>
    <button id="start3">Start</button>
    <pre id="error">Error log:</pre>
</body>
</html>
