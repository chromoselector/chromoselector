/**
 * ChromoSelector 2.0.0 for jQuery 1.3+
 *
 * All code (c) 2013 - Copyright www.chromoselector.com - All Rights Reserved.
 * Written by Rouslan Placella <info@chromoselector.com>
 * Unauthorized copying of this file, via any medium is strictly prohibited.
 */(function(a,b,c,d){function p(a,b,d){return[d+a*c.cos(b),d+a*c.sin(b)]}function q(a,b,c){return t(a,[b,b])<=c}function r(a,b,c,d){var e=function(a,b,c){return(a[0]-c[0])*(b[1]-c[1])-(b[0]-c[0])*(a[1]-c[1])},f=e(a,b,c)<0,g=e(a,c,d)<0,h=e(a,d,b)<0;return f===g&&g===h}function s(a,b){return-1/((b[1]-a[1])/(b[0]-a[0]))}function t(a,b){var d=a[0]-b[0],e=a[1]-b[1];return c.sqrt(d*d+e*e)}function u(a,b){return b*b===Infinity?[a[0],a[1]+1]:[a[0]+1,b+a[1]]}function v(a,b,c,d){var e=(d[1]-c[1])*(b[0]-a[0])-(d[0]-c[0])*(b[1]-a[1]),f=(d[0]-c[0])*(a[1]-c[1])-(d[1]-c[1])*(a[0]-c[0]),g=f/e;return[a[0]+g*(b[0]-a[0]),a[1]+g*(b[1]-a[1])]}function w(a,b,c,d){var e,f=(b+c*a.width)*4;for(e=0;e<4;e++)a.data[f+e]=d[e]}function x(a,b,c,d){var e=v(d,[d[0]+20,d[1]],a,b),f=v(d,[d[0]+20,d[1]],a,c),g;return d[0]<e[0]?g=255:d[0]>f[0]?g=0:g=(f[0]-d[0])/(f[0]-e[0])*255,[g,g,g,255]}function z(b,d){var e=b.getContext("2d"),f=a("<canvas>").attr("width",d).attr("height",d)[0],g=f.getContext("2d");if(!y.u){y.u=e.createImageData(80,80);var h,i,j,k,l,m,n,o,p=180/c.PI,q=function(a){return a%=360,a>=240?0:a>=180?255*((240-a)/60):a>=60?255:255*(a/60)};for(i=0;i<80;i++){k=i-40;for(j=0;j<80;j++)l=j-40,h=c.atan2(k,l)*p+270,m=q(h+120),n=q(h),o=q(h+240),w(y.u,i,j,[m,n,o,255])}}e.putImageData(y.u,0,0),g.scale(d/80,d/80),g.drawImage(b,0,0),e.drawImage(f,0,0)}function A(b){var d=b.width,e=b.s[1].getContext("2d");z(b.s[1],d);var f=[d/2,d/2];e[k]="destination-out",e[l]="rgba(0,0,0,1)",e.lineWidth=b.H,e.beginPath(),e.arc(f[0],f[1],b.I-b.H/2,0,c.PI*2,!0),e.closePath(),e.fill();var g=a("<canvas/>").attr("width",d).attr("height",d)[0],h=g.getContext("2d");h[i](0,0,d,d),h[k]="destination-out",h.beginPath(),h.arc(f[0],f[1],b.I+b.H/2,0,c.PI*2,!0),h.closePath(),h.fill(),e.drawImage(g,0,0),e=b.s[0].getContext("2d"),e.lineWidth=b.H-2,e.shadowColor=b.a.shadowColor,e.shadowBlur=b.a.shadow,e.beginPath(),e.arc(f[0],f[1],b.I,0,c.PI*2,!0),e.closePath(),e.stroke()}function B(a){var b=a.color.getHsl().h,d=a.s[2],e=d.getContext("2d");e.clearRect(0,0,a.width,a.width);var f=-c.PI/2,g=E(a,f),l;if(!a.A){var m=e.createImageData(a.width,a.width),o=function(a,b){return{start:c.round(c.min(a[0][b]-3,a[1][b]-3,a[2][b]-3)),end:c.round(c.max(a[0][b]+3,a[1][b]+3,a[2][b]+3))}},p=o(g,0),q=o(g,1),r,s;for(r=g[0][0]-3;r<=p.end;r++)for(s=q.start+(1.7*(r-g[0][0])|0)-3;s<=q.end;s++)w(m,r,s,x(g[0],g[1],g[2],[r,s]));for(r=p.start;r<=g[0][0]-3;r++)for(s=q.start-(1.7*(r-g[0][0])|0)-3;s<=q.end;s++)w(m,r,s,x(g[0],g[1],g[2],[r,s]));l=a.t.getContext("2d"),l.putImageData(m,0,0);var t=l.createLinearGradient(0,q.start,0,q.end);t[h](1,"rgba(0,0,0,0)"),t[h](0,"rgba(0,0,0,1)"),l[j]=t,l[k]="destination-out",l[i](p.start,q.start,p.end,q.end),l[k]="source-over"}f=(1-b)*c.PI*2,g=E(a,f),e[j]=(new n({h:b,s:1,l:.5})).getHexString(),e[i](0,0,a.width,a.width),e.save(),e.translate(a.width/2,a.width/2),e.rotate(f+c.PI/2),e.translate(-a.width/2,-a.width/2),e.drawImage(a.t,0,0),e.restore(),e.beginPath(),e.moveTo(0,0),e.lineTo(g[1][0],g[1][1]),e.lineTo(g[0][0],g[0][1]),e.lineTo(g[2][0],g[2][1]),e.lineTo(g[1][0],g[1][1]),e.lineTo(0,0),e.lineTo(0,a.width),e.lineTo(a.width,a.width),e.lineTo(a.width,0),e.lineTo(0,0),e.closePath(),e[k]="destination-out",e[j]="rgba(0,0,0,1)",e.fill();var u=function(b,c){var d=1/(a.width/2)*2;return a.width/2*d+g[b][c]*(1-d)};e[k]="destination-over",e.beginPath(),e.moveTo(u(0,0),u(0,1)),e.lineTo(u(1,0),u(1,1)),e.lineTo(u(2,0),u(2,1)),e.closePath(),e[j]="rgba(0,0,0,1)",e.shadowColor=a.a.shadowColor,e.shadowBlur=a.a.shadow,e.fill(),e.shadowColor="rgba(0,0,0,0)",e.shadowBlur=0,e[k]="source-over"}function C(a){var b=a.s[3],d=b.getContext("2d");d.clearRect(0,0,a.width,a.width);var e=(1-a.color.getHsl().h)*c.PI*2,f=E(a,e),g=p(a.I,e,a.width/2),h=[f[1][0]*a.color.getHsl().l+(1-a.color.getHsl().l)*f[2][0],f[1][1]*a.color.getHsl().l+(1-a.color.getHsl().l)*f[2][1]],i=s(f[1],f[2]),j=u(h,i),k=v(h,j,f[1],f[2]),m=t(f[1],f[2]),n=t(f[2],k),o=f[2];n>=m/2&&(o=f[1]);var q=v(h,j,f[0],o);h=[q[0]*a.color.getHsl().s+(1-a.color.getHsl().s)*k[0],q[1]*a.color.getHsl().s+(1-a.color.getHsl().s)*k[1]];var r=[g,h];for(var w in r)d[l]="#fff",d.lineWidth=1.5,d.beginPath(),d.arc(r[w][0],r[w][1],6,0,c.PI*2,!0),d.closePath(),d.stroke(),d.lineWidth=2,d[l]="rgba(0,0,0,1)",d.beginPath(),d.arc(r[w][0],r[w][1],4.5,0,c.PI*2,!0),d.closePath(),d.stroke()}function D(a,b){var c=b.getContext("2d");a.n.css("border-bottom-color")?c[l]=a.n.css("border-bottom-color"):c[l]="#444",c.lineWidth=1,c.lineCap="round",c.beginPath(),c.moveTo(0,18),c.lineTo(18,0),c.moveTo(7,18),c.lineTo(18,7),c.moveTo(13,18),c.lineTo(18,13),c.closePath(),c.stroke()}function E(a,b){var d,e=[];for(d=0;d<3;d++)e[d]=p(a.r,b,a.width/2),b-=c.PI*2/3;return e}function F(a,b){var d=X(a,b,a.d),e=c.atan2(d[0]-a.width/2,d[1]-a.width/2)*(180/c.PI)+270,f=a.color.getHsla();a.color.setColor({h:e/360,s:f.s,l:f.l,a:f.a}),B(a),C(a),a.E(a)}function G(a,b,c){var d=a.color.getHsla();a.color.setColor({h:d.h,s:b,l:c,a:d.a}),C(a),a.E(a)}function H(a){a.a.autosave&&I(a),a.a.preview&&a.j.find("div").css("background",a.color.getRgbaString()),a.e.trigger("update")}function I(a){var b="";typeof a.a.color2str=="function"?b=a.a.color2str.call(null,a.color):b=a.color.getHexString(),typeof a.a.save=="function"?a.a.save.call(a.e[0],b):a.e.val(b).html(b)}function J(a,b){var c;typeof a.a.load=="function"?c=a.a.load.call(a.e):c=a.e.val()||a.e.html(),typeof a.a.str2color=="function"?a.color=new n(a.a.str2color.call(null,c)):a.color=new n(c),a.a.preview&&a.j&&a.j.find("div").css("background",a.color.getRgbaString()),b&&(B(a),C(a))}function K(a,b){if(a.J){clearTimeout(a.J),a.J=0;return}a.A?(J(a),B(a),C(a)):P(a);if(typeof b!="undefined"){b=parseInt(b,10);if(b<0||isNaN(b))b=a.a.speed}else b=a.a.speed;var c=a.e.triggerHandler("beforeShow");if(typeof c=="undefined"||c){V(a),$(a);var d=a.effect==="fade"?"fadeIn":"slideDown";a.n[d].call(a.n,b,function(){V(a),a.e.trigger("show")}),a.o&&a.o.setHeight(a.b.height())}}function L(a,b){a.J=setTimeout(function(){if(a.k&&a.k.find("select:focus").length)return;a.J=0;if(typeof b!="undefined"){b=parseInt(b,10);if(b<0||isNaN(b))b=a.a.speed}else b=a.a.speed;var c=a.e.triggerHandler("beforeHide");if(typeof c=="undefined"||c){var d=a.effect==="fade"?"fadeOut":"slideUp";a.n[d].call(a.n,b,function(){V(a),a.e.trigger("hide")})}},100)}function M(a,b){var d=(1-a.color.getHsl().h)*c.PI*2,e=E(a,d),f=X(a,b,a.d),g=f;if(!r(f,e[0],e[1],e[2])){var h,i=[];for(h=0;h<3;h++)i[h]=t(e[h],f);var j=c.max.apply(null,i);for(h=0;h<3;h++)if(i[h]===j){g=N(f,e,i,h);break}}var k=O(e[0],e[1],e[2],g,a.color.getHsl().h);G(a,k.s,k.l)}function N(a,b,d,e){var f=[0,1,2],g=[1,0,1],h=[2,2,0],i=v(a,b[f[e]],b[g[e]],b[h[e]]);if(t(i,b[f[e]])>=t(b[0],b[1])){var j,k=c.min.apply(null,d);for(j=0;j<3;j++)if(d[j]===k){i=b[j];break}}return i}function O(a,b,c,d,e){var f=s(b,c),g=u(d,f),h=v(d,g,b,c),i=t(b,c),j=t(c,h),k=c;j>=i/2&&(k=b),f=s(a,k),g=u(d,f);var l=v(d,h,a,k),m=t(h,d),n=t(h,l),o=m/n;return isNaN(o)&&(o=0),{h:e,s:o,l:j/i}}function P(a){A(a),B(a),C(a),a.A=1,a.e.trigger("ready")}function Q(a,b){var d=X(a,b,a.d);if(a.a.panel||a.a.panelAlpha)d[0]-=a.o.getWidth();var e=U(a,c.max(d[0],d[1])+c.max(a.D[0],a.D[1]));R(a,e),a.e.trigger("resize")}function R(a,b){a.b.width(b).height(b+a.j.outerHeight()),a.a.panel||a.a.panelAlpha?(a.n.width(a.o.getWidth()+a.b.width()),a.o.setHeight(a.b.height())):a.n.width(a.b.width()),a.d.width(b).height(b);if(a.a.roundcorners){var c="0px 0px 0px "+b/2+"px";!a.a.resizable&&!a.a.panel&&!a.a.panelAlpha&&(c="0px 0px "+b/2+"px "+b/2+"px"),a.n.css({"-webkit-border-radius":c,"border-radius":c})}$(a)}function S(a,b){b!==a.width&&(a.A=0,a.width=b,a.r=b/2-15-a.a.ringwidth,a.H=a.a.ringwidth,a.I=a.width/2-a.H/2-10,a.s.each(function(){this.width=b,this.height=b}).add(a.b),a.t.width=b,a.t.height=b,R(a,b),P(a))}function T(a){a.preventDefault()}function U(a,b){return b|=0,a.a.maxWidth<a.a.minWidth&&(a.a.maxWidth=a.a.minWidth),b>a.a.maxWidth?b=a.a.maxWidth:b<a.a.minWidth&&(b=a.a.minWidth),b+=b%2,b}function V(a){var b=a.e.offset(),c=a.c.offset();a.G||(a.c.css({top:0,left:0}),a.n.css({top:b.top+a.e.outerHeight(),left:b.left})),a.e.is(":visible")?(a.f.show().css("top",b.top-c.top+(a.e.outerHeight()-a.f.height())/2),a.a.iconpos==="left"?a.f.css("left",b.left-c.left-a.f.outerWidth()-2):a.f.css("left",b.left-c.left+a.e.outerWidth()+2)):a.f.hide()}function W(b,c){var e=d[b],f,h=["rgb","hsl","cmyk"];if(typeof c!="undefined")if(b==="panelMode")a.inArray(c,h)&&(e=c);else if(b==="panelModes"){for(var i in c)a.inArray(c[i],h)||delete c[i];e=c}else if(b==="panelChannelWidth")f=parseInt(c)||0,f>=10&&f<=40&&(e=f+f%2);else if(b==="panelChannelMargin")f=parseInt(c)||0,f>=0&&f<=50&&(e=f+f%2);else if(b==="panel"||b==="panelAlpha")e=!!c;else if(b==="shadowColor"&&typeof c=="string"&&c.length)e=(new n(c)).getRgbaString();else if(b==="effect")e=c==="slide"?"slide":"fade";else if(b==="iconpos")e=c==="left"?"left":"right";else if(b==="target"){e=null;if(typeof c=="string"||typeof c=="object"){var j=a(c);j&&typeof j[0]=="object"&&(e=j)}}else b==="icon"&&typeof c=="string"&&c.length?e=c:b==="iconalt"&&typeof c=="string"&&c.length?e=c:b==="pickerClass"&&typeof c=="string"&&c.length?e=c:b.match(/^autoshow|autosave|resizable|preview|roundcorners$/)?e=!!c:b.match(/^minWidth|maxWidth$/)?(f=parseInt(c,10)||0,e=f>100?f:100):b.match(/^speed|width|shadow|ringwidth$/)?(f=parseInt(c,10)||0,e=f>0?f:0):((new RegExp("^"+g+"$")).test(b)||/^save|load|str2color|color2str$/.test(b))&&typeof c=="function"&&(e=c);return e}function X(a,b,c){var d=0,f=0,g=b.originalEvent,h=g.touches||g.changedTouches,i,j;a?(i=c.parent().offset(),j=a.j.outerHeight()):(i=c.offset(),j=0);if(h)d=h[0].pageX-i.left,f=h[0].pageY-i.top-j;else if(b.pageX){var k=g.clientX+e.body.scrollLeft,l=g.clientY+e.body.scrollTop;e.documentElement&&(k+=e.documentElement.scrollLeft,l+=e.documentElement.scrollTop),d=k-i.left,f=l-i.top-j}return[d,f]}function Y(a){return a.n.width()}function Z(a){return a.n.height()}function $(a){var b=a.i.height();a.g.height(b),a.h.css("top","-"+b+"px").height(b);var c=a.g[0].getContext("2d");a.g[0].height=b,a.g[0].width=1e3,a.g.css("width","1000px");var d=e.createElement("canvas");d.height=10,d.width=10;var f=d.getContext("2d");f[j]="#ccc",f[i](0,0,10,10),f[j]="#888",f[i](0,0,5,5),f[i](5,5,5,5);var g=c.createPattern(d,"repeat");c[j]=g,c[i](0,0,a.width,b)}function _(a,b){return a.each(b)}"use strict";var e=b.document,f="chromoselector",g="create|ready|update|destroy|show|beforeShow|hide|beforeHide|resize|resizeStart|resizeStop",h="addColorStop",i="fillRect",j="fillStyle",k="globalCompositeOperation",l="strokeStyle",m=function(){return function(a,b){var c,d,e,f;return b=b||4,f=function(){e?(a.apply({},d),e=0,c=setTimeout(f,b)):c=0},function(){d=arguments,e=1,c||f()}}}(),n=function(){function b(a){var b=this,c={r:0,g:0,b:0,a:1},r={h:0,s:0,l:0,a:1},s=!1;b.getRgba=function(){return c},b.getRgb=function(){return d(c)},b.getHsla=function(){return s?r:g(c)},b.getHsl=function(){return s?f(r):e(c)},b.getCmyk=function(){return h(c)},b.getRgbaString=function(){return j(c)},b.getRgbString=function(){return i(c)},b.getHexaString=function(){return l(c)},b.getHexString=function(){return k(c)},b.getHslaString=function(){return n(c)},b.getHslString=function(){return m(c)},b.getCmykString=function(){return o(c)},b.getTextColor=function(){return p(c)},b.setColor=function(a){var d=q(a,c,r,s);return c=d.rgba,r=d.hsla,s=d.isHsl,b},b.setAlpha=function(a){return a=parseFloat(a),!isNaN(a)&&a>=0&&a<=1&&(c.a=a,r.a=a),b},b.getAlpha=function(){return c.a},b.setColor(a)}function d(a){var b={};return b.r=a.r,b.g=a.g,b.b=a.b,b}function e(a){var b={},c=w(a);return b.h=c.h,b.s=c.s,b.l=c.l,b}function f(a){var b={};return b.h=a.h,b.s=a.s,b.l=a.l,b}function g(a){return w(a)}function h(a){return y(a)}function i(b){return"rgb("+a(b.r*255)+","+a(b.g*255)+","+a(b.b*255)+")"}function j(b){return"rgba("+a(b.r*255)+","+a(b.g*255)+","+a(b.b*255)+","+a(b.a*100)/100+")"}function k(a){return t(a)}function l(b){var c=a(b.a*255),d=c.toString(16);return c<16&&(d="0"+d),t(b)+d}function m(b){var c=w(b);return"hsl("+a(c.h*360)+","+a(c.s*100)+"%,"+a(c.l*100)+"%)"}function n(b){var c=w(b);return"hsla("+a(c.h*360)+","+a(c.s*100)+"%,"+a(c.l*100)+"%,"+a(c.a*100)/100+")"}function o(b){var c=y(b);return"device-cmyk("+a(c.c*100)/100+","+a(c.m*100)/100+","+a(c.y*100)/100+","+a(c.k*100)/100+")"}function p(a){var c=a.r*.2126+a.g*.7152+a.b*.0722;return new b(c<.35?"#fff":"#000")}function q(a,d,e,f){var g,h,i,j;if(typeof a=="string"){if(/^\s*#/.test(a))/^\s*#([0-9a-f]{3}){1,2}\s*$/i.test(a)?(a=a.replace(/\s*/,""),a.length===4&&(a=a.replace(/[0-9a-f]/gi,r)),d=u(a),d.a=1,f=!1):/^\s*#([0-9a-f]{4}){1,2}\s*$/i.test(a)&&(a=a.replace(/\s*/,""),a.length===5&&(a=a.replace(/[0-9a-f]/gi,r)),d=v(a),f=!1);else if(/^\s*rgba/.test(a)){g=a.match(/^\s*rgba\s*\(\s*(\d+%?)\s*,\s*(\d+%?)\s*,\s*(\d+%?)\s*,\s*(\.\d+|\d+\.?\d*)\s*\)\s*$/);if(g&&g.length===5){g.shift(),i=g.pop()/1,i>1?i=1:i<0&&(i=0);for(h=0;h<g.length;h++)g[h].indexOf("%")!==-1?g[h]=g[h].substr(0,g[h].length-1)/100:g[h]=g[h]/255,g[h]>1?g[h]=1:g[h]<0&&(g[h]=0);d.r=g[0],d.g=g[1],d.b=g[2],d.a=i,f=!1}}else if(/^\s*rgb/.test(a)){g=a.match(/^\s*rgb\s*\(\s*(\d+%?)\s*,\s*(\d+%?)\s*,\s*(\d+%?)\s*\)\s*$/);if(g&&g.length===4){g.shift();for(h=0;h<g.length;h++)g[h].indexOf("%")!==-1?g[h]=g[h].substr(0,g[h].length-1)/100:g[h]=g[h]/255,g[h]>1?g[h]=1:g[h]<0&&(g[h]=0);d.r=g[0],d.g=g[1],d.b=g[2],d.a=1,f=!1}}else if(/^\s*hsla/.test(a)){g=a.match(/^\s*hsla\s*\(\s*(\d+)\s*,\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\.\d+|\d+\.?\d*)\s*\)\s*$/);if(g&&g.length===5){g.shift(),j=g.shift()/360,j-=c.floor(j),j<0&&(j=1+j),i=g.pop()/1,i>1?i=1:i<0&&(i=0);if(g.length===2){for(h=0;h<g.length;h++)g[h]=g[h].substr(0,g[h].length-1)/100,g[h]>1?g[h]=1:g[h]<0&&(g[h]=0);f=!0,e={h:j,s:g[0],l:g[1],a:i}}}}else if(/^\s*hsl/.test(a)){g=a.match(/^\s*hsl\s*\(\s*(\d+)\s*,\s*(\d+%)\s*,\s*(\d+%)\s*\)\s*$/);if(g&&g.length===4){g.shift(),j=g.shift()/360,j-=c.floor(j),j<0&&(j=1+j);for(h=0;h<g.length;h++)g[h]=g[h].substr(0,g[h].length-1)/100,g[h]>1?g[h]=1:g[h]<0&&(g[h]=0);f=!0,e={h:j,s:g[0],l:g[1],a:1}}}else if(/^\s*device-cmyk/.test(a)){g=a.match(/^\s*device-cmyk\s*\(\s*(\.\d+|\d+\.?\d*)\s*,\s*(\.\d+|\d+\.?\d*)\s*,\s*(\.\d+|\d+\.?\d*)\s*,\s*(\.\d+|\d+\.?\d*)\s*\)\s*$/);if(g&&g.length===5){g.shift();for(h=0;h<g.length;h++)g[h]=g[h]/1,g[h]>1?g[h]=1:g[h]<0&&(g[h]=0);d=z({c:g[0],m:g[1],y:g[2],k:g[3]}),f=!1}}}else if(a instanceof b){var k=a.getRgba();s(a,"rgba")&&(d=k,f=!1)}else if(typeof a=="object"){for(h in a)a[h]=parseFloat(a[h]);s(a,"sl")&&!isNaN(a.h)?(f=!0,a.h=a.h-c.floor(a.h),a.h<0&&(a.h=1+a.h),e=a,i=1,s(a,"a")&&(i=a.a),e.a=i):s(a,"rgb")?(d=a,i=1,s(a,"a")&&(i=a.a),d.a=i,f=!1):s(a,"cmyk")&&(d=z(a),d.a=1,f=!1)}return f?{rgba:x(e),hsla:e,isHsl:!0}:{rgba:d,hsla:w(d),isHsl:!1}}function r(a){return a+a}function s(a,b){var c,d;for(c in b.split("")){d=parseFloat(a[b[c]]);if(isNaN(d)||d<0||d>1)return 0}return 1}function t(b){var c,d,e="",f=0;for(;f<3;f++)d=a(b[["r","g","b"][f]]*255),c=d.toString(16),d<16&&(c="0"+c),e+=c;return"#"+e}function u(a){var b=0,c={};for(;b<3;b++)c[b]=parseInt("0x"+a.substring(b*2+1,b*2+3),16)/255;return{r:c[0],g:c[1],b:c[2]}}function v(a){var b=0,c={};for(;b<4;b++)c[b]=parseInt("0x"+a.substring(b*2+1,b*2+3),16)/255;return{r:c[0],g:c[1],b:c[2],a:c[3]}}function w(a){var b=a.r,d=a.g,e=a.b,f=c.max(b,d,e),g=c.min(b,d,e),h,i,j=(f+g)/2;if(f===g)h=i=0;else{var k=f-g;i=j>.5?k/(2-f-g):k/(f+g);switch(f){case b:h=(d-e)/k+(d<e?6:0);break;case d:h=(e-b)/k+2;break;case e:h=(b-d)/k+4}h/=6}return{h:h,s:i,l:j,a:a.a}}function x(a){var b,c,d;if(a.s===0)b=c=d=a.l;else{var e=function(a,b,c){return c<0?c+=1:c>1&&(c-=1),c<1/6?a+(b-a)*6*c:c<.5?b:c<2/3?a+(b-a)*(2/3-c)*6:a},f;a.l<.5?f=a.l*(1+a.s):f=a.l+a.s-a.l*a.s;var g=2*a.l-f;b=e(g,f,a.h+1/3),c=e(g,f,a.h),d=e(g,f,a.h-1/3)}return{r:b,g:c,b:d,a:a.a}}function y(a){if(a.r===a.g&&a.g===a.b)return{c:0,m:0,y:0,k:1-a.r};var b=c.min(1-a.r,1-a.g,1-a.b);return{c:(1-a.r-b)/(1-b),m:(1-a.g-b)/(1-b),y:(1-a.b-b)/(1-b),k:b}}function z(a){return{r:1-c.min(1,a.c*(1-a.k)+a.k),g:1-c.min(1,a.m*(1-a.k)+a.k),b:1-c.min(1,a.y*(1-a.k)+a.k),a:1}}var a=c.round;return b}(),o=function(){return function(d,f,g,k,o,p,q,r,s,t,u){var v=this,w=function(){var a=J;return k&&(a+=q+r),o?J+q:M==="cmyk"?a+q*4+r*3:a+q*3+r*2},x=function(b,c,d){var e=a.extend({},b);return e[c]=d,new n(e)},y=function(){return ab.createLinearGradient(0,W-q/2-10,0,q/2+10)},z=function(a,b){K=y(),K[h](0,a.getHexString()),K[h](1,b.getHexString()),ab[l]=K},A=function(){K=y(),K[h](0,"#f00"),K[h](1/6,"#ff0"),K[h](2/6,"#0f0"),K[h](.5,"#0ff"),K[h](4/6,"#00f"),K[h](5/6,"#f0f"),K[h](1,"#f00"),ab[l]=K},B=function(a){K=y(),K[h](0,"#000"),K[h](.5,a.getHexString()),K[h](1,"#fff"),ab[l]=K},C=function(a){K=y(),K[h](0,a.getHexString()),K[h](1,"#000"),ab[l]=K},D=function(){ab.clearRect(0,0,w(),W),G();var b,c,d,f,g,m,p=10,s=0,t=function(){ab.beginPath(),ab.moveTo(p+q/2,q/2+10),ab.lineTo(p+q/2,W-q/2-10),ab.lineWidth=q,ab.lineCap="round",ab.stroke()};if(k){var u=e.createElement("canvas");u.height=10,u.width=10;var v=u.getContext("2d");v[j]="#ccc",v[i](0,0,10,10),v[j]="#888",v[i](0,0,5,5),v[i](5,5,5,5);var D=ab.createPattern(u,"repeat");ab[l]=D,t(),K=y(),K[h](0,(new n(L)).setAlpha(0).getRgbaString()),K[h](1,L.getHexString()),ab[l]=K,t(),p+=q+r,s=1}if(o)E();else if(M==="rgb"){for(b in N)c=x(L.getRgb(),N[b],0),d=x(L.getRgb(),N[b],1),z(c,d),t(),p+=q+r,s++;E(L.getRgb())}else if(M==="hsl")A(),t(),s++,p+=q+r,c=x(L.getHsl(),"s",0),d=x(L.getHsl(),"s",1),z(c,d),t(),s++,p+=q+r,f=a.extend({},L.getHsl()),f.l=.5,B(new n(f)),t(),E(L.getHsl());else if(M==="cmyk"){m="cmy".split("");for(b in m)c=x(L.getCmyk(),m[b],0),d=x(L.getCmyk(),m[b],1),z(c,d),t(),p+=q+r,s++;g=a.extend({},L.getCmyk()),g.k=0,g=new n(g),C(g),t(),E(L.getCmyk())}},E=function(a){var b=10,d,e,f,g,h=function(a,b,d){ab[l]=a,ab.lineWidth=b,ab.beginPath(),ab.arc(e,f,d,0,c.PI*2,!0),ab.closePath(),ab.stroke()};k&&(e=b+q/2,g=W-q-20,f=g-g*L.getAlpha()+q/2+10,b+=q+r,h("#fff",1.5,6),h("#000",2,4.5));if(!o)for(d in a)e=b+q/2,g=W-q-20,f=g-g*a[d]+q/2+10,h("#fff",1.5,6),h("#000",2,4.5),b+=q+r},F=function(a){ab.shadowColor=u,ab.shadowBlur=t,ab.beginPath(),ab.moveTo(a,q/2+10),ab.lineTo(a,W-q/2-10),ab.lineWidth=q-2,ab[l]="rgba(0,0,0,1)",ab.lineCap="round",ab.stroke(),ab.shadowBlur=0},G=function(){if(t>0){var a,b=10,c;k&&(a=b+q/2,F(a),b+=q+r);if(!o)for(c in N)a=b+q/2,F(a),b+=q+r}},H=function(){var b=0;k||o?Z.append(a("<div />").text("A").width(q).css({"padding-left":10})):o||(Z.append(a("<div />").text(N[0].toUpperCase()).width(q).css({"padding-left":10})),b++);if(!o)for(;b<N.length;b++)Z.append(a("<div />").text(N[b].toUpperCase()).width(q).css({"padding-left":r}))},I=m(function(a){var b=X(!1,a,Y),e=W-q,f=e-c.round(b[1]-q/2);f<0?f=0:f>e&&(f=e);var g=f/e;if(k&&P===0)L.setAlpha(g);else if(!o){var h=P;k&&h--;var i="get"+M.charAt(0).toUpperCase()+M.slice(1),j=L[i]();j[N[h]]=g,j.a=L.getAlpha(),L=new n(j)}D(),d.trigger("update")});v.getColor=function(){return L},v.getWidth=function(){return w()},v.setAlpha=function(a){return L.setAlpha(a),v},v.setColor=function(a){return L=new n(a),D(),v},v.setHeight=function(a){return ab.clearRect(0,0,w(),W),$=Z.outerHeight(!0),S.width(w()-20),W=a-S.outerHeight(!0)-$,Y.attr("height",W),D(),v},v.setMode=function(b){return a.inArray(b,R)>=0&&(S.val(b),M=b,N=b.split(""),Y.attr("width",w()),D(),s&&(Z.width(w()).children().remove(),H()),S.width(w()-20)),v};var J=20,K,L=new n,M="rgb",N=M.split(""),O=0,P=0,Q=0,R=["rgb","hsl","cmyk"],S=a("<select/>");if(!o&&g.length){var U="<option/>";for(var V in g)S.append(a(U).html(g[V]));d.append(S),Q=S.outerHeight(!0)}var W=p-Q,Y=a("<canvas/>").attr("width",w()).attr("height",W).css("display","block");d.append(Y);var Z=a(),$=0;s&&(Z=a("<div />").addClass("ui-panel-labels").width(w()),H(),d.append(Z));var _=Y[0],ab=_.getContext("2d");v.setMode(f),o||S.change(function(){v.setMode(a(":selected",this).val())}),d.add(Z.find("div")).bind("mousedown touchstart",function(b){a(this).is(b.target)&&T(b)}),Y.bind("mousedown touchstart",function(b){T(b),P=0;var c=10,d=X(!1,b,a(this));while(P<5&&!O)d[0]>c&&d[0]<c+q?(O=1,I(b)):(P++,c+=q+r)}).bind("mousemove touchmove",function(a){var b=X(!1,a,Y),c=Y.width(),d=J/2;if(b[0]>d&&b[1]>d&&b[0]<c-d&&b[1]<Y.height()-d){var e=d;while(e<c){if(b[0]>e&&b[0]<q+e){Y.css("cursor","crosshair");break}Y.css("cursor",""),e+=q+r}}else Y.css("cursor","")}),a([b,e]).bind("mousemove touchmove",function(a){O&&(T(a),I(a))}).bind("mouseup touchend",function(a){O&&(T(a),O=0,I(a))})}}(),y={},ab=function(d,g){var h=this;h.A=0,h.a=g,h.x=0,h.w=m(F),h.z=0,h.y=m(M),h.C=0,h.B=m(Q),h.E=m(H,100),h.F=m(function(a,b){a.color.setColor(b),B(a),C(a),a.E(a)}),h.a.ringwidth>h.a.minWidth/4&&(h.a.ringwidth=c.floor(h.a.minWidth/4)),h.J=0,h.e=d,J(h),h.width=U(h,h.a.width),h.H=h.a.ringwidth,h.I=h.width/2-h.H/2-10,h.r=h.width/2-15-h.a.ringwidth;var i='<canvas width="'+h.width+'" height="'+h.width+'"></canvas>',j="";h.a.target&&h.a.target.length?(h.G=1,h.c=h.a.target,j="ui-cs-static"):(h.G=0,h.c=a("<div/>").prependTo("body").css({width:0,height:0,position:"absolute",overflow:"visible"})),h.d=a("<div/>").addClass("ui-cs-widget").css({position:"relative"}).width(h.width).height(h.width).html(i+i+i+i),h.b=a("<div/>").append(h.d).width(h.width).addClass("ui-cs-container"),h.m=a("<div/>").addClass("ui-cs-supercontainer").append(h.b),h.n=a("<div/>").addClass("ui-cs-chromoselector").addClass(h.a.pickerClass).addClass(j).append(h.m);if(h.a.panel||h.a.panelAlpha)h.k=a("<div/>").addClass("ui-cs-panel"),h.m.append(h.k),h.o=new o(h.k,h.a.panelMode,h.a.panelModes,h.a.panelAlpha,!h.a.panel,100,h.a.panelChannelWidth,h.a.panelChannelMargin,!0,h.a.shadow,h.a.shadowColor),h.o.setColor(h.color.getRgba()),h.k.bind("update",function(){h.F(h,h.o.getColor().getHsla())}),h.e.bind("update",function(){h.o.setColor(h.color.getHsla())}),h.k.find("select").blur(function(){L(h)}).change(function(){h.n.width(h.o.getWidth()+h.b.width())});h.a.icon?(h.f=a("<a/>",{href:"#",tabindex:"999"}).addClass("ui-cs-icon").css("position","absolute").append(a("<img/>",{alt:h.a.iconalt,src:h.a.icon}).load(function(){a(this).parent().height(a(this).height()),a(this).parent().width(a(this).width()),V(h)})),h.c.append(h.f)):h.f=a([]),h.a.resizable&&(h.l=a("<canvas />").height(20).width(20).attr("height",20).attr("width",20).addClass("ui-cs-resizer").css({position:"absolute",bottom:"0px",right:"0px"}),D(h,h.l[0]),h.m.append(h.l)),h.m.append(a("<div/>").css("clear","both")),h.i=a("<div/>").addClass("ui-cs-preview-widget").css("overflow","hidden").css("background",h.color.getRgbaString());var k=new n(h.a.shadowColor);k.setAlpha(k.getAlpha()-.1);var l="0 0 "+c.max(0,h.a.shadow-2)+"px 0 "+k.getRgbaString();h.j=a("<div/>").addClass("ui-cs-preview-container").append(h.i.append(a("<canvas/>").css({display:"block"})).css("box-shadow",l).css("-webkit-box-shadow",l)),h.a.preview&&h.b.prepend(h.j),h.h=a("<div/>").addClass("ui-cs-preview-color").css("width","100%").css("background-color",h.color.getRgbaString()).css("position","relative"),h.i.append(h.h),h.g=h.i.find("canvas"),$(h);if(h.a.roundcorners){var p="0px 0px 0px "+h.width/2+"px";!h.a.resizable&&!h.a.panel&&!h.a.panelAlpha&&(p="0px 0px "+h.width/2+"px "+h.width/2+"px"),h.n.css({"-webkit-border-radius":p,"border-radius":p})}h.d.height(h.width).add(h.b).width(h.width),h.a.panel||h.a.panelAlpha?h.n.width(h.o.getWidth()+h.b.width()):h.n.width(h.b.width()),h.c.append(h.n.hide()),h.s=h.d.find("canvas").css({position:"absolute",width:"100%",height:"100%"}),h.t=a(i)[0],h.effect="fade",h.a.effect==="slide"&&(h.effect="slide");if(h.a.autoshow){h.a.lazy?h.e.bind("mouseover."+f,function(){h.A||P(h),h.e.unbind("mouseover."+f)}):P(h);var s=h.e;h.f.length&&(s=h.f),s.bind("focus click",function(a){T(a),h.A||P(h),K(h)}).blur(function(){L(h)}),h.e.keydown(function(a){a.keyCode===27&&L(h)})}h.e.keyup(function(){h.e.trigger("update"),J(h),B(h),C(h)}),h.a.resizable&&h.l.bind("mousedown touchstart",function(a){T(a);var b=X(h,a,h.d);h.e.trigger("resizeStart"),h.C=1,h.D=[h.width-b[0],h.width-b[1]]}),h.b.bind("mousedown touchstart",function(a){T(a);var b=X(h,a,h.d);if(q(b,h.width/2,h.I+h.H)&&!q(b,h.width/2,h.I-h.H))h.x=1,h.w(h,a);else{var d=(1-h.color.getHsl().h)*c.PI*2,e=E(h,d);r(b,e[0],e[1],e[2])&&(h.z=1,h.y(h,a))}}).bind("mousemove touchmove",function(a){var b=X(h,a,h.d);if(q(b,h.width/2,h.I+h.H/2)&&!q(b,h.width/2,h.I-h.H/2))h.d.css("cursor","crosshair");else{var d=(1-h.color.getHsl().h)*c.PI*2,e=E(h,d);r(b,e[0],e[1],e[2])?h.d.css("cursor","crosshair"):h.d.css("cursor","")}}),a([b,e]).bind("mousemove touchmove",function(a){h.x?(T(a),h.w(h,a)):h.z?(T(a),h.y(h,a)):h.C&&(T(a),h.B(h,a))}).bind("mouseup touchend",function(a){h.x?(T(a),h.x=0,F(h,a)):h.z?(T(a),h.z=0,M(h,a)):h.C&&(T(a),h.C=0,S(h,h.d.width()),h.e.trigger("resizeStop"))}).bind("resize",function(){V(h)}),setTimeout(function(){V(h)},4)},bb={init:function(b){var c={};b=b?b:{};for(var e in d)c[e]=W(e,b[e]);return _(this,function(){var b=a(this);if(!b.data(f)){b.data(f,new ab(b,c));var d,e=g.split("|");for(d in e){var h=e[d],i=c[h];typeof i=="function"&&b.bind(h+"."+f,i)}b.trigger("create")}})},show:function(b){return _(this,function(){K(a(this).data(f),b)})},hide:function(b){return _(this,function(){L(a(this).data(f),b)})},save:function(){return _(this,function(){I(a(this).data(f))})},load:function(){return _(this,function(){J(a(this).data(f),1)})},setColor:function(b){return _(this,function(){var c=a(this).data(f);c.F(c,b)})},getColor:function(){return this.data(f).color},getWidth:function(){return Y(a(this).data(f))},getHeight:function(){return Z(a(this).data(f))},resize:function(b){return _(this,function(){var c=a(this).data(f);c.e.trigger("resizeStart"),S(c,b),c.e.trigger("resize").trigger("resizeStop")})},reflow:function(){return _(this,function(){V(a(this).data(f))})},api:function(){var a={},b=this;return a.show=function(a){return bb.show.call(b,a),this},a.hide=function(a){return bb.hide.call(b,a),this},a.save=function(){return bb.save.call(b),this},a.load=function(){return bb.load.call(b),this},a.getColor=function(){return bb.getColor.call(b)},a.getWidth=function(){return bb.getWidth.call(b)},a.getHeight=function(){return bb.getHeight.call(b)},a.setColor=function(a){return bb.setColor.call(b,a),this},a.destroy=function(){bb.destroy.call(b)},a.resize=function(a){return bb.resize.call(b,a),this},a.reflow=function(){return bb.reflow.call(b),this},a},destroy:function(){return _(this,function(){var b=a(this).data(f);b.G?b.b.siblings().length?b.b.remove():b.c.remove():b.c.remove(),a(this).removeData(f).trigger("destroy").unbind("."+f)})}};a.fn[f]=function(b){var c=1;try{var d=e.createElement("canvas"),g=d.getContext("2d");g.createImageData(5,5)}catch(h){c=0}if(!c)return b==="getColor"?new n:b==="getWidth"||b==="getHeight"?0:this;if(bb[b])return bb[b].apply(this,Array.prototype.slice.call(arguments,1));if(typeof b=="object"||!b)return bb.init.apply(this,arguments);a.error("Method "+b+" does not exist on jQuery."+f)},a.fn[f].defaults=function(a,b){return typeof b=="undefined"?d[a]:(d[a]=W(a,b),this)},a.fn[f].Color=n})(jQuery,window,Math,{autoshow:!0,autosave:!0,pickerClass:"",speed:400,minWidth:120,maxWidth:400,width:180,ringwidth:18,resizable:!0,shadow:6,shadowColor:"rgba(0,0,0,0.6)",preview:!0,panel:!1,panelAlpha:!1,panelChannelWidth:18,panelChannelMargin:12,panelMode:"rgb",panelModes:["rgb","hsl","cmyk"],roundcorners:!0,effect:"fade",icon:null,iconalt:"Open Color Picker",iconpos:"right",lazy:!0,target:null,create:null,ready:null,destroy:null,update:null,beforeShow:null,show:null,beforeHide:null,hide:null,resize:null,resizeStart:null,resizeStop:null,save:null,load:null,str2color:null,color2str:null});